<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Calculadora de Leech - Ragnarok</title>
  <style>
	body {
	font-family: Arial, sans-serif;
	/* fundo com imagem + fallback escuro */
	background: #020617 url("https://github.com/este141/LeechCalculator/blob/main/640px-PvPbatalha.jpg?raw=true") no-repeat center center fixed;
	background-size: cover;
	color: #e5e7eb;
	margin: 0;
	padding: 20px;
	}
	.card {
	background: rgba(15, 23, 42, 0.75); /* azul escuro com ~75% opacidade */
	border-radius: 12px;
	padding: 16px 18px;
	margin-bottom: 20px;
	box-shadow: 0 4px 14px rgba(0,0,0,0.6);
	backdrop-filter: blur(4px); /* opcional: efeito de vidro fosco */
	}
    label {
      display: block;
      margin-top: 8px;
      margin-bottom: 4px;
      font-weight: bold;
      font-size: 14px;
    }
    input, select {
      width: 100%;
      padding: 7px 9px;
      border-radius: 8px;
      border: 1px solid #374151;
      background: rgba(2, 6, 23, 0.8); /* antes: #020617 */
      color: #e5e7eb;
      font-size: 14px;
    }
    .row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .row > div {
      flex: 1;
      min-width: 150px;
    }
    button {
      margin-top: 12px;
      padding: 10px 16px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      font-weight: bold;
      background: #facc15;
      color: #111827;
    }
    button:hover {
      background: #eab308;
    }
    .small-btn {
      padding: 6px 10px;
      font-size: 12px;
      margin-right: 6px;
      margin-top: 6px;
    }
    .results p {
      margin: 4px 0;
      font-size: 14px;
    }
    code {
      background: rgba(2, 6, 23, 0.8); /* antes: #020617 */
      padding: 2px 4px;
      border-radius: 4px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
      font-size: 13px;
    }
    th, td {
      border: 1px solid #1f2937;
      padding: 5px 6px;
      text-align: left;
    }
    th {
      background: rgba(2, 6, 23, 0.8); /* antes: #020617 */
    }
    .radio-group {
      display: flex;
      gap: 16px;
      margin-top: 4px;
      font-size: 14px;
    }
    .radio-group label {
      font-weight: normal;
      margin-top: 0;
    }
    .checkbox-line {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      font-weight: normal;
      margin-top: 6px;
    }
    .checkbox-line input {
      width: auto;
    }
    .buff-box {
      margin-top: 8px;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid #1f2937;
      background: rgba(2, 6, 23, 0.8); /* antes: #020617 */
    }
    .discount-box {
      margin-top: 10px;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #1f2937;
      background: rgba(2, 6, 23, 0.8); /* antes: #020617 */
      max-width: 260px;
    }
    hr {
      border: none;
      border-top: 1px solid #1f2937;
      margin: 16px 0;
    }
  </style>
</head>
<body>
  <h1>Calculadora de Leech - Cotoco</h1>

  <!-- Banner / imagem externa -->
  <div style="text-align:center; margin-bottom: 20px;">
    <img
      src="https://github.com/este141/LeechCalculator/blob/main/btns_gde_regras.png?raw=true"
      alt="Banner Ragnarok"
      style="max-width: 100%; height: auto; border-radius: 12px;"
    >
  </div>

  <!-- CONFIGURAÇÃO DE TAXA / PREÇO -->
  <div class="card">
    <h2>1) Configuração da taxa de EXP e preço (serviço de referência)</h2>
    <p style="font-size:13px;">
      Aqui você define um serviço base que você já conhece (por exemplo: <b>Thor 84→99</b> em
      <b>1h</b> por <b>R$ 25</b>). A calculadora acha:
      <b>EXP/hora</b> e <b>R$/hora</b>, e usa isso para tudo.
    </p>

    <table>
      <thead>
        <tr>
          <th>Preset</th>
          <th>Leecher</th>
          <th>Faixa</th>
          <th>EXP/h estimada</th>
          <th>Ação</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Leech Thor</td>
          <td>Arroz</td>
          <td>84 → 99</td>
          <td><code>86.000.000 EXP/h</code></td>
          <td>
            <button class="small-btn" onclick="setRefFromPreset('thor_arroz')">
              Usar como referência
            </button>
          </td>
        </tr>
        <tr>
          <td>Leech Thor</td>
          <td>Lelouch</td>
          <td>84 → 99</td>
          <td><code>84.000.000 EXP/h</code></td>
          <td>
            <button class="small-btn" onclick="setRefFromPreset('thor_lelouch')">
              Usar como referência
            </button>
          </td>
        </tr>
        <tr>
          <td>Leech Anolians</td>
          <td>Cotoco</td>
          <td>1 → 84 (recomendado 1–70)</td>
          <td><code>14.000.000 EXP/h</code></td>
          <td>
            <button class="small-btn" onclick="setRefFromPreset('anolians_cotoco')">
              Usar como referência
            </button>
          </td>
        </tr>
        <tr>
          <td>Leech Lago do Abismo 4</td>
          <td>Cotoco</td>
          <td>69 → 99 (recomendado 69–84)</td>
          <td><code>31.000.000 EXP/h</code></td>
          <td>
            <button class="small-btn" onclick="setRefFromPreset('lava_cotoco')">
              Usar como referência
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <label for="refExp">EXP do serviço de referência (total daquele serviço)</label>
    <input id="refExp" type="text" placeholder="Ex: 165000000 (para 1h com 165M/h)" />

    <div class="row">
      <div>
        <label for="refHours">Tempo do serviço de referência - Horas</label>
        <input id="refHours" type="text" placeholder="Ex: 1" />
      </div>
      <div>
        <label for="refMinutes">Tempo do serviço de referência - Minutos</label>
        <input id="refMinutes" type="text" placeholder="Ex: 0" />
      </div>
    </div>

    <label for="refPrice">Preço do serviço de referência (R$)</label>
    <input id="refPrice" type="text" placeholder="Ex: 25" />

    <hr>

    <h3 style="font-size:14px;">Bônus de EXP ativos</h3>
    <p style="font-size:12px; margin-top:0;">
      Marque os itens/eventos que estão ativos. Eles aumentam a <b>EXP/hora</b>, mas não mudam o <b>R$/hora</b>.
    </p>

    <div class="buff-box">
      <label class="checkbox-line">
        <input type="checkbox" id="buff_manual">
        Manual de combate (+50% EXP)
      </label>
      <label class="checkbox-line">
        <input type="checkbox" id="buff_visuais">
        Visuais de EXP (+20% EXP)
      </label>
      <label class="checkbox-line">
        <input type="checkbox" id="buff_lata">
        Lata de ração para gatos (+10% EXP)
      </label>
      <label class="checkbox-line">
        <input type="checkbox" id="buff_mascar">
        Manual de mascar (+10% EXP)
      </label>
      <label class="checkbox-line">
        <input type="checkbox" id="buff_double">
        Evento de Double EXP (x2 na EXP final)
      </label>
    </div>

    <div id="refInfo" class="results" style="margin-top:10px;font-size:13px;color:#a5b4fc;"></div>
  </div>

  <!-- CALCULADORA DE NIVEL POR TEMPO -->
  <div class="card">
    <h2>2) Calculadora de nível por tempo (1 → 99)</h2>
    <p style="font-size:13px;">
      Informe o <b>nível atual</b> do cliente, o <b>tempo de leech</b> e se é <b>transclasse</b> ou não.
      A calculadora usa a taxa configurada acima (já com buffs de EXP) para estimar até que nível ele chega
      e quanto você deve cobrar.
    </p>

    <div class="radio-group">
      <label><input type="radio" name="classType1" value="non" checked> Não-transclasse</label>
      <label><input type="radio" name="classType1" value="trans"> Transclasse</label>
    </div>

    <div class="row">
      <div>
        <label for="startLevel">Nível atual do cliente</label>
        <input id="startLevel" type="number" min="1" max="99" placeholder="Ex: 70" />
      </div>
      <div>
        <label for="leechHours">Tempo de leech - Horas</label>
        <input id="leechHours" type="text" placeholder="Ex: 0" />
      </div>
      <div>
        <label for="leechMinutes">Tempo de leech - Minutos</label>
        <input id="leechMinutes" type="text" placeholder="Ex: 30" />
      </div>
    </div>

    <button onclick="calculateLevelByTime()">Calcular nível e valor</button>

    <div class="results" id="levelResults"></div>
  </div>

  <!-- CALCULADORA DE PACOTES -->
  <div class="card">
    <h2>3) Calculadora de pacotes (1–84, 1–70, 1–99, 84–99 e combo)</h2>
    <p style="font-size:13px;">
      Aqui você monta um pacote fechado. A EXP é dividida em três faixas:
      <b>1–69</b>, <b>69–84</b> e <b>84–99</b>, e você escolhe qual tipo de leech será usado em cada uma.
      Thor só aparece na faixa 84–99 e Lago do Abismo só a partir do 69, respeitando as restrições de nível.
      O combo inclui <b>1→99 não-trans + 1→99 transclasse</b>.
    </p>

    <label for="packageType">Tipo de pacote</label>
    <select id="packageType">
      <option value="84_99">84 → 99</option>
      <option value="1_84">1 → 84</option>
      <option value="1_70">1 → 70</option>
      <option value="1_99">1 → 99</option>
      <option value="combo_1_99">Combo 1 → 99 não-trans + 1 → 99 transclasse</option>
    </select>

    <div class="row" style="margin-top:10px;">
      <div>
        <label for="leechRange1">Leech para 1 → 69</label>
        <select id="leechRange1">
          <option value="anolians">Anolians (Cotoco)</option>
        </select>
      </div>
      <div>
        <label for="leechRange2">Leech para 69 → 84</label>
        <select id="leechRange2">
          <option value="anolians">Anolians (Cotoco)</option>
          <option value="lava">Lago do Abismo 4 (Cotoco)</option>
        </select>
      </div>
      <div>
        <label for="leechRange3">Leech para 84 → 99</label>
        <select id="leechRange3">
          <option value="thor_arroz">Thor (Arroz)</option>
          <option value="thor_lelouch">Thor (Lelouch)</option>
        </select>
      </div>
    </div>

    <div class="radio-group" style="margin-top:8px;">
      <label><input type="radio" name="classType2" value="non" checked> Não-transclasse</label>
      <label><input type="radio" name="classType2" value="trans"> Transclasse</label>
    </div>

    <div class="discount-box">
      <label class="checkbox-line" style="margin-top:0;">
        <input type="checkbox" id="discount20">
        Aplicar desconto de 20% (pacotes)
      </label>
    </div>

    <button onclick="calculatePackages()">Calcular pacote</button>

    <div class="results" id="fullRangeResults"></div>
  </div>

  <!-- TEXTO DE MARKETING / AVISOS -->
  <div class="card">
    <h2>4) Sobre o serviço de leech Cotoco</h2>
    <p style="font-size:13px;">
      Somos um grupo de jogadores dedicados a oferecer o <b>melhor leech possível</b>, com foco em
      segurança, constância e transparência. Toda a base desta calculadora foi montada usando
      <b>dados reais do emulador</b>, somas exatas de tabela de EXP e testes práticos in-game,
      para chegar o mais próximo possível da realidade.
    </p>
    <p style="font-size:13px;">
      Ainda assim, é importante lembrar que sempre podem existir pequenas variações que a calculadora
      não consegue prever, como:
    </p>
    <ul style="font-size:13px; padding-left:18px; margin-top:4px;">
      <li>Mapa muito cheio de jogadores competindo por mob.</li>
      <li>Buffs e debuffs específicos do mapa (aura verde, penalidades, bônus de evento etc.).</li>
      <li>DC, lag, morte inesperada ou qualquer situação fora do padrão de farm.</li>
    </ul>
    <p style="font-size:13px;">
      Por isso, os resultados aqui devem ser usados como <b>estimativa profissional</b>, e não como
      promessa exata de minuto a minuto. Na prática, nosso objetivo é <b>entregar sempre mais do que
      a conta mostra</b>, mantendo uma experiência de leech honesta, rápida e bem organizada.
    </p>
  </div>

  <script>
    // ======= TABELAS DE EXP =======

    const expNonTrans = [
      0,
      9,16,25,36,77,112,153,200,253,320,
      385,490,585,700,830,970,1120,1260,1420,1620,
      1860,1990,2240,2504,2950,3426,3934,4474,6889,7995,
      9174,10425,11748,13967,15775,17678,19677,21773,30543,34212,
      38065,42102,46323,53026,58419,64041,69892,75973,102468,115254,
      128692,142784,157528,178184,196300,215198,234879,255341,330188,365914,
      403224,442116,482590,536948,585191,635278,687211,740988,925400,1473746,
      1594058,1718928,1848355,1982340,2230113,2386162,2547417,2713878,3206160,3681024,
      4022472,4377024,4744680,5125440,5767272,6204000,6655464,7121664,7602600,9738720,
      11649960,13643520,18339300,23836800,35658000,48687000,58135000,99999998,99999999
    ];

    const expTrans = [
      0,
      10,18,28,40,85,123,168,220,278,400,
      481,613,731,875,1038,1213,1400,1575,1775,2268,
      2604,2786,3136,3506,4130,4796,5508,6264,9645,12392,
      14220,16159,18209,21649,24451,27401,30499,33748,47342,58160,
      64711,71573,78749,90144,99312,108870,118816,129154,174196,213220,
      238080,264150,291427,329640,363155,398116,434526,472381,610848,731828,
      806448,884232,965180,1073896,1170382,1270556,1374422,1481976,1850800,3389616,
      3666333,3953534,4251217,4559382,5129260,5488173,5859059,6241919,7374168,9570662,
      10458427,11380262,12336168,13326144,14994907,16130400,17304206,18516326,19766760,29216160,
      34949880,40930560,55017900,71510400,106974000,146061000,174405000,343210000,99999999
    ];

    // EXP/h base por tipo de leech (sem buffs)
    const LEECH_BASE_RATES = {
      anolians: 14000000,
      lava: 31000000,
      thor_arroz: 86000000,
      thor_lelouch: 84000000
    };

    // ======= FUNÇÕES AUXILIARES =======

    function parseNumber(str) {
      if (!str) return NaN;
      str = str.toString().trim().replace(/\./g, '').replace(',', '.');
      return parseFloat(str);
    }

    function formatNumber(n) {
      return n.toLocaleString('pt-BR');
    }

    // soma EXP de startLevel..endLevel-1
    function getRangeExp(expTable, startLevel, endLevel) {
      let total = 0;
      for (let lvl = startLevel; lvl < endLevel; lvl++) {
        total += expTable[lvl];
      }
      return total;
    }

    function setRefFromPreset(preset) {
      if (preset === 'thor_arroz') {
        document.getElementById('refExp').value = 86000000;
        document.getElementById('refHours').value = '1';
        document.getElementById('refMinutes').value = '0';
        document.getElementById('refPrice').value = '25';
      } else if (preset === 'thor_lelouch') {
        document.getElementById('refExp').value = 84000000;
        document.getElementById('refHours').value = '1';
        document.getElementById('refMinutes').value = '0';
        document.getElementById('refPrice').value = '30';
      } else if (preset === 'anolians_cotoco') {
        document.getElementById('refExp').value = 14000000;
        document.getElementById('refHours').value = '1';
        document.getElementById('refMinutes').value = '0';
        document.getElementById('refPrice').value = '25';
      } else if (preset === 'lava_cotoco') {
        document.getElementById('refExp').value = 78000000;
        document.getElementById('refHours').value = '1';
        document.getElementById('refMinutes').value = '0';
        document.getElementById('refPrice').value = '40';
      }
      updateRefInfo();
    }

    function getRefData() {
      const refExp = parseNumber(document.getElementById('refExp').value);
      const refHours = parseNumber(document.getElementById('refHours').value);
      const refMinutes = parseNumber(document.getElementById('refMinutes').value);
      const refPrice = parseNumber(document.getElementById('refPrice').value);

      if (isNaN(refExp) || isNaN(refHours) || isNaN(refMinutes) || isNaN(refPrice)) {
        return { ok: false };
      }

      const totalRefHours = refHours + (refMinutes / 60);
      if (totalRefHours <= 0) {
        return { ok: false };
      }

      const expPerHourBase = refExp / totalRefHours;
      const pricePerHour = refPrice / totalRefHours;

      // buffs de EXP
      const buffManual  = document.getElementById('buff_manual').checked;
      const buffVisuais = document.getElementById('buff_visuais').checked;
      const buffLata    = document.getElementById('buff_lata').checked;
      const buffMascar  = document.getElementById('buff_mascar').checked;
      const buffDouble  = document.getElementById('buff_double').checked;

      // bônus que somam (itens)
      let additiveBonus = 0;
      if (buffManual)  additiveBonus += 0.5; // +50%
      if (buffVisuais) additiveBonus += 0.2; // +20%
      if (buffLata)    additiveBonus += 0.1; // +10%
      if (buffMascar)  additiveBonus += 0.1; // +10%

      // primeiro soma os bônus de item
      let multiplier = 1 + additiveBonus;

      // depois aplica o evento de double EXP em cima de tudo
      if (buffDouble) {
        multiplier *= 2; // dobra inclusive os bônus
      }

      const expPerHourFinal = expPerHourBase * multiplier;

      return {
        ok: true,
        refExp,
        totalRefHours,
        refPrice,
        expPerHourBase,
        expPerHourFinal,
        pricePerHour,
        multiplier
      };
    }

    function updateRefInfo() {
      const infoDiv = document.getElementById('refInfo');
      const data = getRefData();
      if (!data.ok) {
        infoDiv.innerHTML = '<p>Preencha EXP, tempo e preço para definir a taxa base.</p>';
        return;
      }

      const bonusPercent = (data.multiplier - 1) * 100;

      infoDiv.innerHTML = `
        <p><b>Taxa definida:</b></p>
        <p>• EXP/hora base (sem buffs): <b>${formatNumber(data.expPerHourBase.toFixed(2))}</b></p>
        <p>• Bônus de EXP: <b>${bonusPercent.toFixed(1)}%</b> (multiplicador x${data.multiplier.toFixed(2)})</p>
        <p>• EXP/hora final (com buffs): <b>${formatNumber(data.expPerHourFinal.toFixed(2))}</b></p>
        <p>• R$/hora: <b>R$ ${data.pricePerHour.toFixed(2)}</b></p>
      `;
    }

    document.getElementById('refExp').addEventListener('input', updateRefInfo);
    document.getElementById('refHours').addEventListener('input', updateRefInfo);
    document.getElementById('refMinutes').addEventListener('input', updateRefInfo);
    document.getElementById('refPrice').addEventListener('input', updateRefInfo);

    ['buff_manual','buff_visuais','buff_lata','buff_mascar','buff_double'].forEach(id => {
      const el = document.getElementById(id);
      if (el) el.addEventListener('change', updateRefInfo);
    });

    function simulateLevel(expTable, startLevel, expGain) {
      let level = startLevel;
      let expInLevel = 0;

      while (expGain > 0 && level < 99) {
        const needed = expTable[level] - expInLevel;

        if (expGain >= needed) {
          expGain -= needed;
          level += 1;
          expInLevel = 0;
        } else {
          expInLevel += expGain;
          expGain = 0;
        }
      }

      let percent = 0;
      if (level < 99) {
        percent = (expInLevel / expTable[level]) * 100;
      }

      return {
        level,
        percent,
        expInLevel
      };
    }

    // ======= CALCULADORA 2: NIVEL POR TEMPO =======

    function calculateLevelByTime() {
      const refData = getRefData();
      const resultsDiv = document.getElementById('levelResults');

      if (!refData.ok) {
        resultsDiv.innerHTML = '<p style="color:#fca5a5;">Primeiro configure o serviço de referência na seção 1.</p>';
        return;
      }

      const classType = document.querySelector('input[name="classType1"]:checked').value;
      const startLevel = parseInt(document.getElementById('startLevel').value, 10);
      const leechHours = parseNumber(document.getElementById('leechHours').value);
      const leechMinutes = parseNumber(document.getElementById('leechMinutes').value);

      if (isNaN(startLevel) || startLevel < 1 || startLevel > 99) {
        resultsDiv.innerHTML = '<p style="color:#fca5a5;">Informe um nível inicial entre 1 e 99.</p>';
        return;
      }
      if (isNaN(leechHours) || isNaN(leechMinutes)) {
        resultsDiv.innerHTML = '<p style="color:#fca5a5;">Informe o tempo de leech (horas e minutos).</p>';
        return;
      }

      const totalHours = leechHours + (leechMinutes / 60);
      if (totalHours <= 0) {
        resultsDiv.innerHTML = '<p style="color:#fca5a5;">O tempo de leech deve ser maior que zero.</p>';
        return;
      }

      const expGain = refData.expPerHourFinal * totalHours;
      const price = refData.pricePerHour * totalHours;

      const expTable = classType === 'trans' ? expTrans : expNonTrans;
      const sim = simulateLevel(expTable, startLevel, expGain);

      resultsDiv.innerHTML = `
        <h3>Resultado</h3>
        <p>• EXP estimada ganha: <b>${formatNumber(Math.round(expGain))}</b></p>
        <p>• Nível estimado final: <b>${sim.level}</b></p>
        <p>• Barra no nível ${sim.level}: <b>${sim.percent.toFixed(1)}%</b></p>
        <p>• Valor sugerido para esse leech: <b>R$ ${price.toFixed(2)}</b></p>
      `;
    }

    // ======= CALCULADORA 3: PACOTES =======

    function getLeechRateFromSelect(selectId, refData) {
      const key = document.getElementById(selectId).value;
      const base = LEECH_BASE_RATES[key] || refData.expPerHourBase;
      return base * refData.multiplier;
    }

    function calculatePackages() {
      const refData = getRefData();
      const resultsDiv = document.getElementById('fullRangeResults');

      if (!refData.ok) {
        resultsDiv.innerHTML = '<p style="color:#fca5a5;">Primeiro configure o serviço de referência na seção 1.</p>';
        return;
      }

      const packageType = document.getElementById('packageType').value;
      const classType = document.querySelector('input[name="classType2"]:checked').value;
      const discountOn = document.getElementById('discount20').checked;

      const leechRate1 = getLeechRateFromSelect('leechRange1', refData); // 1–69
      const leechRate2 = getLeechRateFromSelect('leechRange2', refData); // 69–84
      const leechRate3 = getLeechRateFromSelect('leechRange3', refData); // 84–99

      const table = classType === 'trans' ? expTrans : expNonTrans;

      // Exp por faixa (não-trans ou trans, conforme escolha)
      const exp1_69  = getRangeExp(table, 1, 69);  // 1..68
      const exp69_84 = getRangeExp(table, 69, 84); // 69..83
      const exp84_99 = getRangeExp(table, 84, 99); // 84..98

      let totalExp = 0;
      let totalHours = 0;
      let descPacote = '';

      if (packageType === '84_99') {
        totalExp = exp84_99;
        totalHours = exp84_99 / leechRate3;
        descPacote = `Pacote 84 → 99 (${classType === 'trans' ? 'Transclasse' : 'Não-trans'})`;
      } else if (packageType === '1_84') {
        const exp1 = exp1_69;
        const exp2 = exp69_84;
        totalExp = exp1 + exp2;
        totalHours = (exp1 / leechRate1) + (exp2 / leechRate2);
        descPacote = `Pacote 1 → 84 (${classType === 'trans' ? 'Transclasse' : 'Não-trans'})`;
      } else if (packageType === '1_70') {
        const exp1 = getRangeExp(table, 1, 69);   // 1..68
        const exp2 = getRangeExp(table, 69, 70);  // 69
        totalExp = exp1 + exp2;
        totalHours = (exp1 / leechRate1) + (exp2 / leechRate2);
        descPacote = `Pacote 1 → 70 (${classType === 'trans' ? 'Transclasse' : 'Não-trans'})`;
      } else if (packageType === '1_99') {
        totalExp = exp1_69 + exp69_84 + exp84_99;
        totalHours = (exp1_69 / leechRate1) + (exp69_84 / leechRate2) + (exp84_99 / leechRate3);
        descPacote = `Pacote 1 → 99 (${classType === 'trans' ? 'Transclasse' : 'Não-trans'})`;
      } else if (packageType === 'combo_1_99') {
        // Combo: 1–99 não-trans + 1–99 trans
        const exp1_69_non  = getRangeExp(expNonTrans, 1, 69);
        const exp69_84_non = getRangeExp(expNonTrans, 69, 84);
        const exp84_99_non = getRangeExp(expNonTrans, 84, 99);
        const exp1_69_trans  = getRangeExp(expTrans, 1, 69);
        const exp69_84_trans = getRangeExp(expTrans, 69, 84);
        const exp84_99_trans = getRangeExp(expTrans, 84, 99);

        const totalExpNon  = exp1_69_non + exp69_84_non + exp84_99_non;
        const totalExpTrans = exp1_69_trans + exp69_84_trans + exp84_99_trans;

        const hoursNon  = (exp1_69_non / leechRate1) + (exp69_84_non / leechRate2) + (exp84_99_non / leechRate3);
        const hoursTrans = (exp1_69_trans / leechRate1) + (exp69_84_trans / leechRate2) + (exp84_99_trans / leechRate3);

        totalExp = totalExpNon + totalExpTrans;
        totalHours = hoursNon + hoursTrans;
        descPacote = 'Combo 1 → 99 não-trans + 1 → 99 transclasse';
      }

      let h = Math.floor(totalHours);
      let m = Math.round((totalHours - h) * 60);
      if (m === 60) { h += 1; m = 0; }

      const priceOriginal = refData.pricePerHour * totalHours;
      const priceFinal = discountOn ? priceOriginal * 0.8 : priceOriginal;

      resultsDiv.innerHTML = `
        <h3>${descPacote}</h3>
        <p>• EXP total necessária: <b>${formatNumber(Math.round(totalExp))}</b></p>
        <p>• Tempo estimado com buffs atuais: <b>~ ${h}h ${m}min</b> (${totalHours.toFixed(2)} h)</p>
        <p>• Valor proporcional: <b>R$ ${priceOriginal.toFixed(2)}</b></p>
        ${discountOn ? `<p>• Valor com desconto de 20%: <b>R$ ${priceFinal.toFixed(2)}</b></p>` : ''}
      `;
    }

    // Inicializa texto
    updateRefInfo();
  </script>
</body>
</html>



